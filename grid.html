<link rel="import" href="components/polymer/polymer.html">

<link rel="import" href="image-service/image-service.html">

<polymer-element name="images-grid">

  <!--<link href="components/core-icons/core-icons.html" rel="import">-->
  <!--<link href="components/core-icon-button/core-icon-button.html" rel="import">-->
  <!--<link href="components/core-toolbar/core-toolbar.html" rel="import"> -->
  <!--<link href="components/core-animated-pages/core-animated-pages.html" rel="import">-->

  
  
  <template>
    <style>
    :host {
        display: block;
        width: 100%;
        height:100%;
      }
    /*body {*/
    /*  font-family: sans-serif;*/
    /*}*/

    /*.toolbar {*/
    /*  background-color: steelblue;*/
    /*}*/

    /*#container {*/
    /*  overflow: auto;*/
    /*}*/

    .card {
      position: relative;
      height: 150px;
      width: 150px;
      font-size: 50px;
      margin: 8px;
      background-color: tomato;
      border-radius: 4px;
      cursor: default;
    }

    .view {
      font-size: 250px;
      background-color: tomato;
      height: 300px;
    }

  </style>
    
    <!--<core-toolbar class="toolbar">-->
    <!--  <core-icon-button icon="{{$.pages.selected != 0 ? 'arrow-back' : 'menu'}}" on-tap="{{back}}"></core-icon-button>-->
    <!--  <div flex>Stuff</div>-->
    <!--  <core-icon-button icon="more-vert"></core-icon-button>-->
    <!--</core-toolbar>-->
    <core-animated-pages flex selected="{{page}}" on-core-animated-pages-transition-end="{{transitionend}}" transitions="cross-fade-all hero-transition">

      <section vertical layout>

        <div id="container" flex horizontal wrap around-justified layout hero-p>
          <template repeat="{{item in items}}">
            <div class="card" vertical center center-justified layout hero-id="item-{{item}}"  
                hero?="{{selectedImage === null}}"
                on-tap="{{selectView}}">
              <span cross-fade>{{item}}</span>
            </div>
          </template>
        </div>

      </section>

      <template repeat="{{item in items}}">
        <section vertical layout>
          <div class="view" flex vertical center center-justified layout 
            hero-id="item-{{item}}"
            hero?="{{selectedImage === item + 1}}"
            on-tap="{{selectView}}">
              <!--<span cross-fade>{{item}}</span>-->
              {{item}}
            </div>
        </section>
      </template>

    </core-animated-pages>
  </template>

  <script>
    Polymer({
      
      items: [1, 2, 3, 4, 5, 6, 7, 8],
      page: 0,
      selectedImage: null,
      
      selectView: function(e){
        var selectedId = e.target.templateInstance.model.item;
        
        console.log("select view="+ selectedId);
        
        
        if (this.page === 0 && selectedId) {
          this.selectedImage = selectedId + 1;
          this.page = 1;
        }else{
          this.selectedImage = null;
          this.page = 0;
        }
        console.log("page=" + this.page)
      },
      transitionend: function(){
        console.log("transitionend");
      }
      
    });
    // addEventListener('template-bound', function(e) {
    //   var scope = e.target;
    //   var items = [], count=50;
    //   for (var i=0; i < count; i++) {
    //     items.push(i);
    //   }

    //   scope.items = items;

    //   scope.selectView = function(e) {
    //     var i = e.target.templateInstance.model.item;
    //     this.$.pages.selected = i+1;
    //   }

    //   scope.back = function() {
    //     this.lastSelected = this.$.pages.selected;
    //     console.log(this.lastSelected);
    //     this.$.pages.selected = 0;
    //   }

    //   scope.transitionend = function() {
    //     if (this.lastSelected) {
    //       this.lastSelected = null;
    //     }
    //   }
    // })

  </script>
</polymer-element>